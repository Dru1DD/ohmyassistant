const TelegramApi = require('node-telegram-bot-api')

// const token = PROCESS.env.botToken || ""
const token = process.env.botToken || ""

const bot = new TelegramApi(token, { polling: true })

let instructButtons = {
    reply_markup: JSON.stringify({
        inline_keyboard: [
            [
                {
                    text: "–£—Ç—Ä–µ–Ω–∏–π —É—Ö–æ–¥",
                    callback_data: "morning"
                },
                {
                    text: '–í–µ—á–µ—Ä–Ω–∏–π —É—Ö–æ–¥',
                    callback_data: 'evening'
                }
            ]
        ]
    })
}

let buttonChangeUpdates = {
    reply_markup: JSON.stringify({
        inline_keyboard: [
            [
                {
                    text: '–û–±–Ω–æ–≤–∏—Ç—å',
                    callback_data: '1'
                },
                {
                    text: '–ù–µ –æ–±–Ω–æ–≤–ª—è—Ç—å',
                    callback_data: '2'
                }
            ]
        ]
    })
}
bot.setMyCommands([
    {
        command: '/start',
        description: "–ù–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å–≤–∏–µ"
    },
    {
        command: '/info',
        description: '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ'
    },
    {
        command: '/update',
        description: '–°–æ—Å—Ç–∞–≤ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–≥–æ –±–æ—Ç–∞'
    },
    {
        command: '/instruction',
        description: '–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—é'
    }
])

let update = false

const start = () => {
    bot.on('message', async msg => {
        const text = msg.text
        const chatId = msg.chat.id
        if(text === '/start') {
            await bot.sendMessage(chatId, '–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å. –Ø –≤–∞—à –ª–∏—á–Ω—ã–π OhMy –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç. –Ø –±—É–¥—É –≤–∞–º –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ–±–Ω–æ–ª–µ–Ω–∏—è –≤–∞—à–µ–≥–æ —Ç–æ–≤–∞—Ä–∞')
            await bot.sendMessage(chatId, '–°–ø–∞—Å–∏–±–æ —Ç–µ–±–µ, —á—Ç–æ –≤—ã–±–∏—Ä–∞–µ—à—å –∏–º–µ–Ω–Ω–æ OhMy')
            return bot.sendMessage(chatId, `–í–∞—à –Ω–∏–∫–Ω–µ–π–º: ${msg.from.username}`)
        }
        if(text === "/info") {
           return bot.sendMessage(chatId, `–¢–µ–±—è –∑–æ–≤—É—Ç ${msg.from.first_name}`)
        }
        if(text === "/update") {
            if(update) {
                return bot.sendMessage(chatId, '–í–∞—à –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Å–æ—Å—Ç–∞–≤ –±–æ–∫—Å–∞: –ü–µ—Ä–≤–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ, –í—Ç–æ—Ä–æ–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ', buttonChangeUpdates)
            } else {
                return bot.sendMessage(chatId, '–í–∞—à —Å–æ—Å—Ç–∞–≤ –±–æ–∫—Å–∞: –ü–µ—Ä–≤–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ, –í—Ç–æ—Ä–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ, –¢—Ä–µ—Ç—å–µ —Å—Ä–µ–¥—Å—Ç–≤–æ', buttonChangeUpdates)
            }
        }
        if (text === "/instruction") {
            return bot.sendMessage(chatId, '–í—ã–±–µ—Ä–∏—Ç–µ —É—Ö–æ–¥: ', instructButtons)
        }
        return bot.sendMessage(chatId, "–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å")
    })

    bot.on('callback_query', async msg => {
        const data = msg.data
        const chatId = msg.message.chat.id
        if (data === 'morning') {
            setTimeout(() => {
                bot.sendMessage(chatId,`
                **–ü–µ—Ä–≤—ã–π —ç—Ç–∞–ø -** –ø—Ä–æ—Å—ã–ø–∞–Ω–∏–µ –∏ ****–æ—á–∏—â–µ–Ω–∏–µ –∫–æ–∂–∏ –ª–∏—Ü–∞. –ì–µ–ª—å –¥–ª—è —É–º—ã–≤–∞–Ω–∏—è. \n
                –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –∑–∏–º–æ–π - –∑–∞–≤–µ—Å—Ç–∏ —Å—É–ø–µ—Ä–º—è–≥–∫–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ –¥–ª—è —É–º—ã–≤–∞–Ω–∏—è, —á—Ç–æ–±—ã –æ–Ω–æ –Ω–µ –æ—Ç–º—ã–≤–∞–ª–æ –∫–æ–∂—É –¥–æ —Å–∫—Ä–∏–ø–∞ –∏ –Ω–µ —Å–º—ã–≤–∞–ª–æ –∂–∏—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—à–µ–π –∫–æ–∂–µ –Ω—É–∂–Ω—ã. \n
                *–ò–Ω–æ–≥–¥–∞, –¥–∞–∂–µ, –µ—Å–ª–∏ –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å, —Å —É—Ç—Ä–∞ –¥–µ—Ä–º–∞—Ç–æ–ª–æ–≥–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é—Ç –Ω–µ —É–º—ã–≤–∞—Ç—å—Å—è –∫–∞–∫–∏–º-—Ç–æ —Å—Ä–µ–¥—Å—Ç–≤–æ–º, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –ø–æ–ª–µ–∑–Ω—ã–µ –∂–∏—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—â–∏—â–∞—é—Ç –∫–æ–∂—É –æ—Ç –∑–∏–º–Ω–∏—Ö –≤–µ—Ç—Ä–æ–≤ –∏ —Å—É—Ö–æ–≥–æ –≤–æ–∑–¥—É—Ö–∞ –≤ –ø–æ–º–µ—â–µ–Ω–∏—è—Ö.* \n
                –î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —ç—Ç–æ—Ç –±–∞—Ä—å–µ—Ä –Ω–µ –Ω–∞—Ä—É—à–∞–ª—Å—è –≤–æ –≤—Ä–µ–º—è –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —É–º—ã–≤–∞–Ω–∏—è - –º—ã –ø–æ–ª–æ–∂–∏–ª–∏ –≥–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É–≤–ª–∞–∂–Ω–∏—Ç –∫–æ–∂—É. `)
            }, 1000)
            setTimeout(() => {
                bot.sendMessage(chatId, `
                –í—Ç–æ—Ä–æ–π —ç—Ç–∞–ø - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–∂–∏ –∫ –Ω–∞–Ω–µ—Å–µ–Ω–∏—é –∫—Ä–µ–º–∞ [–∫ —É–≤–ª–∞–∂–Ω–µ–Ω–∏—é]. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–Ω–∏–∫.  \n
                –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–≤–ª–∞–∂–Ω–µ–Ω–∏—è –æ—á–µ–Ω—å –∑–¥–æ—Ä–æ–≤–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞—Å–ª–∞–∏–≤–∞–Ω–∏–µ –æ–¥–Ω–∏—Ö –Ω–∞ –¥—Ä—É–≥–∏–µ.\n
                `)
            }, 1000)
            setTimeout(() => {
                bot.sendMessage(chatId, `
                –¢—Ä–µ—Ç–∏–π —ç—Ç–∞–ø - —É–≤–ª–∞–∂–Ω–µ–Ω–∏–µ. –ö—Ä–µ–º CeraVe.  \n
                –°–≤–µ—Ä—Ö—É –Ω–∞ –µ—â—ë —Å–ª–µ–≥–∫–∞ –ª–∏–ø–∫—É—é (–∞ –æ–Ω–∞ –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç —Å–ª–µ–≥–∫–∞ –ª–∏–ø–∫–∞—è) –∫–æ–∂—É –Ω—É–∂–Ω–æ –Ω–∞–Ω–æ—Å–∏—Ç—å –∫—Ä–µ–º. –ö—Ä–µ–º –º—ã –≤—ã–±—Ä–∞–ª–∏ CeraVe - –æ–Ω —É–¥–æ–±–Ω—ã–π –ø–æ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –∑–∏–º—ã ‚áí —Ö–æ—Ä–æ—à–æ –∑–∞—â–∏—â–∞–µ—Ç –∏ —É–≤–ª–∞–∂–Ω—è–µ—Ç –∫–æ–∂—É. \n
                –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—É—é –∫–æ—Å–º–µ—Ç–∏–∫—ÉüíÑ\n
                –ò –≤–ø–µ—Ä—ë–¥ –ø–æ–∫–æ—Ä—è—Ç—å —Å—Ü–µ–Ω—É!
                `)
            }, 1000)
        } 
        if(data === 'evening') {
            setTimeout(() => {
                bot.sendMessage(chatId, `–ü–µ—Ä–≤—ã–π —ç—Ç–∞–ø - –æ—á–∏—â–µ–Ω–∏–µ –∫–æ–∂–∏ –ª–∏—Ü–∞. –ì–µ–ª—å –¥–ª—è —É–º—ã–≤–∞–Ω–∏—è.
                –í –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å —Å–º—ã–≤–∞–µ–º –∫–æ—Å–º–µ—Ç–∏–∫—É –∏ —Å–æ–ª—Ü–µ–∑–∞—â–∏—Ç–Ω—ã–π –∫—Ä–µ–º \n
                –ë–∞–∑–æ–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—á–∏—â–µ–Ω–∏—è - –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞–º—ã–ª–∏—Ç—å –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å –ª–∏—Ü–∞ –∏ —Å–º—ã—Ç—å –≤—Å—ë –ø—Ä–æ—Ö–ª–∞–¥–Ω–æ–π –≤–æ–¥–æ–π. –ü–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≥–µ–ª–µ–º –¥–ª—è —É–º—ã–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –∏ –¥–≤–∞ —Ä–∞–∑–∞ –ø–æ–¥—Ä—è–¥, –µ—Å–ª–∏ –µ—Å—Ç—å –æ—â—É—â–µ–Ω–∏–µ –Ω–µ—Å–≤–µ–∂–µ—Å—Ç–∏ –ª–∏—Ü–∞. –í–∞–∂–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø –∑–∏–º–æ–π - —É–º—ã–≤–∞–Ω–∏–µ —Å–ª–µ–≥–∫–∞ –ø—Ä–æ—Ö–ª–∞–¥–Ω–æ–π –≤–æ–¥–æ–π
                `)
            }, 1000)
            setTimeout(() => {
                bot.sendMessage(chatId, `
                –í—Ç–æ—Ä–æ–π —ç—Ç–∞–ø - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–æ–∂–∏ –∫ –Ω–∞–Ω–µ—Å–µ–Ω–∏—é –∫—Ä–µ–º–∞ [–∫ —É–≤–ª–∞–∂–Ω–µ–Ω–∏—é]. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–Ω–∏–∫. \n
                –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —É–≤–ª–∞–∂–Ω–µ–Ω–∏—è –æ—á–µ–Ω—å –∑–¥–æ—Ä–æ–≤–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞—Å–ª–∞–∏–≤–∞–Ω–∏–µ –æ–¥–Ω–∏—Ö –Ω–∞ –¥—Ä—É–≥–∏–µ. –†–∞–±–æ—Ç–∞–µ—Ç —ç—Ç–æ —Ç–∞–∫: \n
                –°–Ω–∞—á–∞–ª–∞ –Ω–∞ –≤–ª–∞–∂–Ω—É—é (—ç—Ç–æ –≤–∞–∂–Ω–æ) –∫–æ–∂—É –Ω–∞–Ω–æ—Å–∏—Ç—Å—è —Å—ã–≤–æ—Ä–æ—Ç–∫–∞/–ª–æ—Å—å–æ–Ω/—Ç–æ–Ω–µ—Ä/–ª–∏—Å—Ç–æ–≤–∞—è –º–∞—Å–∫–∞/—ç—Å—Å–µ–Ω—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≥–ª–∞–≤–Ω—ã–º –æ–±—Ä–∞–∑–æ–º —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –≤–æ–¥–æ—É–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –≠—Ç–æ "–Ω–∞–ø–æ–ª–Ω–∏—Ç" –∫–æ–∂—É –≤–æ–¥–æ–π. –ù–∞ –≤–ª–∞–∂–Ω—É—é –∫–æ–∂—É –∏—Ö –Ω—É–∂–Ω–æ –Ω–∞–Ω–æ—Å–∏—Ç—å –ø–æ—Ç–æ–º—É, —á—Ç–æ —Ä–∞–∑ –æ–Ω–∏ —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤–æ–¥—É, —ç—Ç–∞ –≤–æ–¥–∞ –æ—Ç–∫—É–¥–∞-—Ç–æ –¥–æ–ª–∂–Ω–∞ –≤–∑—è—Ç—å—Å—è. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –æ–Ω–∏ –º–æ–≥—É—Ç –Ω–∞–æ–±–æ—Ä–æ—Ç –≤—ã—Å—É—à–∏–≤–∞—Ç—å –∫–æ–∂—É, –≤—ã—Ç—è–≥–∏–≤–∞—è –≤–æ–¥—É –∏–∑ –≥–ª—É–±–æ–∫–∏—Ö —Å–ª–æ—ë–≤. \n

                `)
            }, 1000)
            setTimeout(() => {
                bot.sendMessage(chatId, `
                –°–Ω–∞—á–∞–ª–∞ –Ω–∞ –≤–ª–∞–∂–Ω—É—é (—ç—Ç–æ –≤–∞–∂–Ω–æ) –∫–æ–∂—É –Ω–∞–Ω–æ—Å–∏—Ç—Å—è —Å—ã–≤–æ—Ä–æ—Ç–∫–∞/–ª–æ—Å—å–æ–Ω/—Ç–æ–Ω–µ—Ä/–ª–∏—Å—Ç–æ–≤–∞—è –º–∞—Å–∫–∞/—ç—Å—Å–µ–Ω—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≥–ª–∞–≤–Ω—ã–º –æ–±—Ä–∞–∑–æ–º —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –≤–æ–¥–æ—É–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –≠—Ç–æ "–Ω–∞–ø–æ–ª–Ω–∏—Ç" –∫–æ–∂—É –≤–æ–¥–æ–π. –ù–∞ –≤–ª–∞–∂–Ω—É—é –∫–æ–∂—É –∏—Ö –Ω—É–∂–Ω–æ –Ω–∞–Ω–æ—Å–∏—Ç—å –ø–æ—Ç–æ–º—É, —á—Ç–æ —Ä–∞–∑ –æ–Ω–∏ —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç –≤–æ–¥—É, —ç—Ç–∞ –≤–æ–¥–∞ –æ—Ç–∫—É–¥–∞-—Ç–æ –¥–æ–ª–∂–Ω–∞ –≤–∑—è—Ç—å—Å—è. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –æ–Ω–∏ –º–æ–≥—É—Ç –Ω–∞–æ–±–æ—Ä–æ—Ç –≤—ã—Å—É—à–∏–≤–∞—Ç—å –∫–æ–∂—É, –≤—ã—Ç—è–≥–∏–≤–∞—è –≤–æ–¥—É –∏–∑ –≥–ª—É–±–æ–∫–∏—Ö —Å–ª–æ—ë–≤.
                `)
            }, 1000)
        }
        if( data === '1') {
            update = true
            bot.sendMessage(chatId, '–í–∞—à –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Å–æ—Å—Ç–∞–≤ –±–æ–∫—Å–∞: –ü–µ—Ä–≤–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ, –í—Ç–æ—Ä–æ–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ', buttonChangeUpdates)
        } 
        if( data === '2') {
            update = false
            bot.sendMessage(chatId, '–í–∞—à —Å–æ—Å—Ç–∞–≤ –±–æ–∫—Å–∞: –ü–µ—Ä–≤–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ, –í—Ç–æ—Ä–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ, –¢—Ä–µ—Ç—å–µ —Å—Ä–µ–¥—Å—Ç–≤–æ', buttonChangeUpdates)
        }
    })
    
}

start()